<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Module otter</title>
<link rel="stylesheet" type="text/css" href="stylesheet.css" title="EDoc">
</head>
<body bgcolor="white">
<div class="navbar"><a name="#navbar_top"></a><table width="100%" border="0" cellspacing="0" cellpadding="2" summary="navigation bar"><tr><td><a href="overview-summary.html" target="overviewFrame">Overview</a></td><td><a href="http://www.erlang.org/"><img src="erlang.png" align="right" border="0" alt="erlang logo"></a></td></tr></table></div>
<hr>

<h1>Module otter</h1>
<ul class="index"><li><a href="#description">Description</a></li><li><a href="#index">Function Index</a></li><li><a href="#functions">Function Details</a></li></ul>otter API module.


<h2><a name="description">Description</a></h2><p>otter API module. Use the API in this module to interact with
   the <code>otter</code> application. If you want to specifically use the
   process dictionary API, use the <code>otter_pdict_api</code> module instead.
   The API is broken down into 3 sections. The <code>Span API</code>,
   <code>Snapshot/Count API</code> and <code>Config API</code>.</p>
  
   <h3><a name="Span_API">Span API</a></h3><p>
   These API calls allow you to create and manage spans. These are:<br>
   <code>start/1, start/2, start/3</code><br>
   <code>finish/1</code> <br>
   <code>ids/1</code> <br>
   <code>log/2, log/3</code> <br>
   <code>tag/3, tag/4</code> <br></p>
  
   <h3><a name="Snapshot/Count_API">Snapshot/Count API</a></h3><p>
   When <code>finish/1</code> is called then the completed span is
   passed to a configurable filter. The filter can check the Span tags
   as well as the name and duration of the span and use the information
   to decide to send the Span to the trace collector (Zipkin supported)
   and/or increase counters based on values of the tags and store the
   last Span for the counters. This latter is particularly useful for
   troubleshooting e.g. error events when increase of the corresponding
   counter is noticed. These snapshots (referred as Snap) and counters
   can be retrieved, managed with this API. These are:<br>
   <code>counter_list/0</code><br>
   <code>counter_snapshot/1</code><br>
   <code>counter_delete/1</code><br>
   <code>counter_delete_all/0</code><br></p>
  
   <h3><a name="Config_API">Config API</a></h3>
   The default implementation uses the application environment to
   store configuration. There is a simple wrapper module to interface
   with configuration store (otter_config). To implement other config
   persistence, the module should be replaced with another one providing
   the same simple read/write API functions.<br>
   <em>WARNING</em> : In the default implementation using the application
   environment, so the write function is NOT persistent. In case of node
   restart and/or application reload the configuration will be reset to
   whatever environment is defined in the release (sys) config or app
   file. There is an example configuration provided in the <code>otter.app</code>
   file as a reference. These are:<br>
   <code>config_list/0</code><br>
   <code>config_read/1</code><br>
   <code>config_read/2</code><br>
   <code>config_write/2</code><br>
<h2><a name="index">Function Index</a></h2>
<table width="100%" border="1" cellspacing="0" cellpadding="2" summary="function index"><tr><td valign="top"><a href="#config_list-0">config_list/0</a></td><td></td></tr>
<tr><td valign="top"><a href="#config_read-1">config_read/1</a></td><td></td></tr>
<tr><td valign="top"><a href="#config_read-2">config_read/2</a></td><td></td></tr>
<tr><td valign="top"><a href="#config_write-2">config_write/2</a></td><td></td></tr>
<tr><td valign="top"><a href="#counter_delete-1">counter_delete/1</a></td><td></td></tr>
<tr><td valign="top"><a href="#counter_delete_all-0">counter_delete_all/0</a></td><td></td></tr>
<tr><td valign="top"><a href="#counter_list-0">counter_list/0</a></td><td></td></tr>
<tr><td valign="top"><a href="#counter_snapshot-1">counter_snapshot/1</a></td><td></td></tr>
<tr><td valign="top"><a href="#finish-1">finish/1</a></td><td>Ends a span and prepares it for potential delivery to the
  backend based on filtering rules.</td></tr>
<tr><td valign="top"><a href="#ids-1">ids/1</a></td><td>Returns the TraceId and SpanId for a given span.</td></tr>
<tr><td valign="top"><a href="#log-2">log/2</a></td><td>Adds a log message to a span.</td></tr>
<tr><td valign="top"><a href="#log-3">log/3</a></td><td></td></tr>
<tr><td valign="top"><a href="#start-1">start/1</a></td><td>Starts a span with the specified name.</td></tr>
<tr><td valign="top"><a href="#start-2">start/2</a></td><td>Starts a span with the specified name and TraceId.</td></tr>
<tr><td valign="top"><a href="#start-3">start/3</a></td><td>Starts a child span with the specified name, TraceId and
  ParentId.</td></tr>
<tr><td valign="top"><a href="#tag-3">tag/3</a></td><td>Adds a tag to a span.</td></tr>
<tr><td valign="top"><a href="#tag-4">tag/4</a></td><td>Adds a tag to a span with a given service.</td></tr>
</table>

<h2><a name="functions">Function Details</a></h2>

<h3 class="function"><a name="config_list-0">config_list/0</a></h3>
<div class="spec">
<p><tt>config_list() -&gt; term()</tt><br></p>
</div>

<h3 class="function"><a name="config_read-1">config_read/1</a></h3>
<div class="spec">
<p><tt>config_read(Key::atom()) -&gt; term()</tt><br></p>
</div>

<h3 class="function"><a name="config_read-2">config_read/2</a></h3>
<div class="spec">
<p><tt>config_read(Key::atom(), Default::term()) -&gt; term()</tt><br></p>
</div>

<h3 class="function"><a name="config_write-2">config_write/2</a></h3>
<div class="spec">
<p><tt>config_write(Key::atom(), Value::term()) -&gt; ok</tt><br></p>
</div>

<h3 class="function"><a name="counter_delete-1">counter_delete/1</a></h3>
<div class="spec">
<p><tt>counter_delete(Key::list()) -&gt; ok</tt><br></p>
</div>

<h3 class="function"><a name="counter_delete_all-0">counter_delete_all/0</a></h3>
<div class="spec">
<p><tt>counter_delete_all() -&gt; ok</tt><br></p>
</div>

<h3 class="function"><a name="counter_list-0">counter_list/0</a></h3>
<div class="spec">
<p><tt>counter_list() -&gt; [{list(), integer()}]</tt><br></p>
</div>

<h3 class="function"><a name="counter_snapshot-1">counter_snapshot/1</a></h3>
<div class="spec">
<p><tt>counter_snapshot(Key::list()) -&gt; term()</tt><br></p>
</div>

<h3 class="function"><a name="finish-1">finish/1</a></h3>
<div class="spec">
<p><tt>finish(Span::<a href="#type-span">span()</a>) -&gt; ok</tt><br></p>
</div><p>Ends a span and prepares it for potential delivery to the
  backend based on filtering rules</p>

<h3 class="function"><a name="ids-1">ids/1</a></h3>
<div class="spec">
<p><tt>ids(Span::<a href="#type-span">span()</a>) -&gt; {<a href="#type-trace_id">trace_id()</a>, <a href="#type-span_id">span_id()</a>}</tt><br></p>
</div><p>Returns the TraceId and SpanId for a given span.</p>

<h3 class="function"><a name="log-2">log/2</a></h3>
<div class="spec">
<p><tt>log(Span::<a href="#type-span">span()</a>, Text::<a href="#type-info">info()</a>) -&gt; <a href="#type-span">span()</a></tt><br></p>
</div><p>Adds a log message to a span</p>

<h3 class="function"><a name="log-3">log/3</a></h3>
<div class="spec">
<p><tt>log(Span::<a href="#type-span">span()</a>, Text::<a href="#type-info">info()</a>, Service::<a href="#type-service">service()</a>) -&gt; <a href="#type-span">span()</a></tt><br></p>
</div>

<h3 class="function"><a name="start-1">start/1</a></h3>
<div class="spec">
<p><tt>start(Name::<a href="#type-info">info()</a>) -&gt; <a href="#type-span">span()</a></tt><br></p>
</div><p>Starts a span with the specified name. Automatically generates
  a TraceId.</p>

<h3 class="function"><a name="start-2">start/2</a></h3>
<div class="spec">
<p><tt>start(Name::<a href="#type-info">info()</a>, TraceId::integer()) -&gt; <a href="#type-span">span()</a></tt><br></p>
</div><p>Starts a span with the specified name and TraceId</p>

<h3 class="function"><a name="start-3">start/3</a></h3>
<div class="spec">
<p><tt>start(Name::<a href="#type-info">info()</a>, TraceId::integer(), ParentId::integer()) -&gt; <a href="#type-span">span()</a></tt><br></p>
</div><p>Starts a child span with the specified name, TraceId and
  ParentId</p>

<h3 class="function"><a name="tag-3">tag/3</a></h3>
<div class="spec">
<p><tt>tag(Span::<a href="#type-span">span()</a>, Key::<a href="#type-info">info()</a>, Value::<a href="#type-info">info()</a>) -&gt; <a href="#type-span">span()</a></tt><br></p>
</div><p>Adds a tag to a span. If the tag already exists, its value
  will be overwritten</p>

<h3 class="function"><a name="tag-4">tag/4</a></h3>
<div class="spec">
<p><tt>tag(Span::<a href="#type-span">span()</a>, Key::<a href="#type-info">info()</a>, Value::<a href="#type-info">info()</a>, Service::<a href="#type-service">service()</a>) -&gt; <a href="#type-span">span()</a></tt><br></p>
</div><p>Adds a tag to a span with a given service. If the tag already
  exists, its value will be overwritten</p>
<hr>

<div class="navbar"><a name="#navbar_bottom"></a><table width="100%" border="0" cellspacing="0" cellpadding="2" summary="navigation bar"><tr><td><a href="overview-summary.html" target="overviewFrame">Overview</a></td><td><a href="http://www.erlang.org/"><img src="erlang.png" align="right" border="0" alt="erlang logo"></a></td></tr></table></div>
<p><i>Generated by EDoc, Apr 14 2017, 04:05:41.</i></p>
</body>
</html>
